my_labelFormat <- function(prefix = "",
suffix = "",
between = " &ndash; ",
digits = 3,
big.mark = ",",
transform = identity) {
formatNum <- function(x) {
format(
round(transform(x), digits),
trim = FALSE,
scientific = FALSE,
big.mark = big.mark
)
}
function(type, ...) {
switch(
type,
bin = (function(cuts) {
n <- length(cuts)
if(n <= 2){
paste0(prefix, formatNum(0), between, formatNum(1), suffix)
}else{
paste0(
prefix,
case_when(
cuts[n] < n-1 ~ paste0(formatNum(cuts[-n]), "0"),
TRUE ~ paste0(formatNum(cuts[-n]), ".0")
),
between,
case_when(
cuts[n] < n-1 ~ formatNum(c(cuts[2:(n-1)] - 0.01, c(cuts[n]))),
TRUE ~ formatNum(c(cuts[2:(n-1)] - 0.1, c(cuts[n])))
),
suffix
)}
})(...)
)
}
}
my_labelFormat(" ", "%", ",", 3, ",")
shiny::runApp()
